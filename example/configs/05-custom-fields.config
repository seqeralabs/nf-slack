/*
 * EXAMPLE 5: Custom Fields
 *
 * Add your own custom fields to notification messages.
 * Fields appear as key-value pairs in the Slack message.
 *
 * New features in this example:
 * - customFields: array of custom field objects
 *   - title: field name
 *   - value: field value
 *   - short: true for column layout, false for full width
 */

plugins {
    id 'nf-slack@0.4.0'
}

slack {
    // Option A: Bot User
    bot {
        token = System.getenv('SLACK_BOT_TOKEN')
        channel = System.getenv('SLACK_CHANNEL_ID')
    }

    // Option B: Webhook
    // webhook {
    //     url = System.getenv('SLACK_WEBHOOK_URL')
    // }

    // Add custom fields to start message
    onStart {
        enabled = true
        message = [
            text: 'üöÄ *Pipeline started*',
            customFields: [
                [title: 'Priority', value: 'High', short: true],
                [title: 'Team', value: 'Bioinformatics', short: true],
                [title: 'Notes', value: 'Running with increased resources', short: false]
            ]
        ]
    }

    // Add custom fields to completion message
    onComplete {
        enabled = true
        message = [
            text: '‚úÖ *Pipeline completed*',
            customFields: [
                [title: 'Status', value: 'Success', short: true],
                [title: 'Quality', value: 'Passed', short: true]
            ]
        ]
    }

    // Add custom fields to error message
    onError {
        enabled = true
        message = [
            text: '‚ùå *Pipeline failed*',
            customFields: [
                [title: 'Support Contact', value: 'team@example.com', short: true],
                [title: 'Action', value: 'Review logs and retry', short: false]
            ]
        ]
    }
}

// Field structure:
// - title: field label (required)
// - value: field content (required)
// - short: true = appears in columns (2 per row)
//         false = appears full width
